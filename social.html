<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>#HUMANITY Social</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- 📦 Libraries for Markdown & Sanitization -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>

  <style>
    body {
      background: #000;
      color: #e0e0e0;
      font-family: 'Courier New', monospace;
      padding: 40px 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: #fff;
      font-size: 3rem;
      letter-spacing: 2px;
      text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff;
      margin-bottom: 30px;
    }

    textarea {
      width: 100%;
      height: 120px;
      background: #0a0a0a;
      color: #fff;
      border: 1px solid #444;
      padding: 15px;
      font-size: 1rem;
      resize: none;
      box-shadow: inset 0 0 5px #0ff;
      border-radius: 6px;
    }

    button {
      display: block;
      margin: 15px auto 30px;
      padding: 12px 28px;
      font-size: 1rem;
      font-weight: bold;
      background: #000;
      color: #fff;
      border: 1px solid #0ff;
      border-radius: 4px;
      box-shadow: 0 0 10px #0ff, inset 0 0 5px #0ff;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    button:hover {
      background: #0ff;
      color: #000;
      box-shadow: 0 0 20px #0ff;
    }

    .post {
      background: #111;
      border: 1px solid #333;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 6px;
      box-shadow: 0 0 10px #0ff1;
    }

    .meta {
      font-size: 0.75rem;
      color: #888;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .post-content {
      font-size: 1rem;
      line-height: 1.4;
    }
    .hidden {
  display: none;
}

#create-username-btn {
  display: block;
  margin: 0 auto 20px;
  padding: 10px 24px;
  background: #000;
  color: #0ff;
  border: 1px solid #0ff;
  border-radius: 4px;
  cursor: pointer;
}
#create-username-btn:hover {
  background: #0ff;
  color: #000;
}

#username-screen {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background: #111;
  padding: 20px;
  border-radius: 6px;
  z-index: 100;
}

  </style>
</head>
<body>
  <h1>#HUMANITY</h1>
<button id="create-username-btn" onclick="showUsernameScreen()">
  Create Username
</button>

<div id="username-screen" class="hidden">
  <h3>Choose Your Username</h3>
  <input id="usernameInput" type="text" placeholder="e.g. NeoCoder" />
  <button onclick="saveUsername()">Go</button>
</div>


  <textarea id="postBox" placeholder="Feed the human feed..."></textarea>
  <button onclick="submitPost()">Share</button>

  <div id="feed"></div>

  <!-- Firebase SDK (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

  <script>
  <script>
  // Initialize Firebase & Firestore
  const firebaseConfig = {
    apiKey:    "AIzaSy…",          // your config
    authDomain:"hashhumanity-58b9a.firebaseapp.com",
    projectId: "hashhumanity-58b9a",
    storageBucket: "hashhumanity-58b9a.appspot.com",
    messagingSenderId: "886745899016",
    appId:     "1:886745899016:web:2b07e043c2434379d71bd"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Markdown → HTML + sanitize
  function formatContent(md) {
    const dirty = marked.parse(md);
    return DOMPurify.sanitize(dirty, {
      ALLOWED_TAGS:  ['b','i','em','strong','a','code','pre','ul','ol','li'],
      ALLOWED_ATTR:  ['href','target']
    });
  }

  // Show “Create Username” modal
  function showUsernameScreen() {
    document.getElementById('username-screen').classList.remove('hidden');
  }

  // Save chosen handle
  function saveUsername() {
    const name = document.getElementById('usernameInput').value.trim();
    if (!name) return alert('Pick a cool username');
    localStorage.setItem('h_username', name);
    document.getElementById('username-screen').classList.add('hidden');
    renderFeed();
  }

  // Post with dynamic author
  async function submitPost() {
    const username = localStorage.getItem('h_username');
    if (!username) return showUsernameScreen();

    const raw = document.getElementById('postBox').value.trim();
    if (!raw) return;

    const html = formatContent(raw);
    await db.collection('posts').add({
      content:   html,
      author:    username,
      timestamp: Date.now()
    });

    document.getElementById('postBox').value = '';
    renderFeed();
  }

  // Render feed, showing each post’s own author
  async function renderFeed() {
    const feed = document.getElementById('feed');
    feed.innerHTML = '';
    const snap = await db.collection('posts')
                         .orderBy('timestamp','desc')
                         .get();

    snap.forEach(doc => {
      const { author, content, timestamp } = doc.data();
      const el = document.createElement('div');
      el.className = 'post';
      el.innerHTML = `
        <div class="meta">
          <strong>${author}</strong> —
          ${new Date(timestamp).toLocaleString()}
        </div>
        <div class="post-content">${content}</div>
      `;
      feed.appendChild(el);
    });
  }

  // On load: hide prompt if set, then load posts
  window.addEventListener('load', () => {
    if (localStorage.getItem('h_username')) {
      document.getElementById('username-screen').classList.add('hidden');
    }
    renderFeed();
  });
</script>

  <script>
  // debug helper—remove later
  function showUsernameScreen() {
    console.log('🔘 button clicked');
    document.getElementById('username-screen')
            .classList.remove('hidden');
  }

  function saveUsername() {
    const name = document.getElementById('usernameInput').value.trim();
    if (!name) return alert('Pick a cool username.');
    localStorage.setItem('h_username', name);
    document.getElementById('username-screen')
            .classList.add('hidden');
    renderFeed(); // or whatever reloads your posts
  }

  // on load, hide if already set
  window.addEventListener('load', () => {
    if (localStorage.getItem('h_username')) {
      document.getElementById('username-screen')
              .classList.add('hidden');
    }
  });
</script>

</body>
</html>


  
